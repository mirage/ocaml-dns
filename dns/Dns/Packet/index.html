<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Packet (dns.Dns.Packet)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">dns</a> &#x00BB; <a href="../index.html">Dns</a> &#x00BB; Packet</nav><h1>Module <code>Dns.Packet</code></h1><p>The DNS packet.</p><p>Encoding and decoding from binary. Definition of types for multiple DNS operations.</p></header><div class="spec module" id="module-Flag"><a href="#module-Flag" class="anchor"></a><code><span class="keyword">module</span> <a href="Flag/index.html">Flag</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Flags"><a href="#module-Flags" class="anchor"></a><code><span class="keyword">module</span> Flags : Stdlib.Set.S <span class="keyword">with</span> <span class="keyword">type</span> <a href="index.html#module-Flags">Flags</a>.elt = <a href="Flag/index.html#type-t">Flag.t</a></code></div><div class="spec module" id="module-Header"><a href="#module-Header" class="anchor"></a><code><span class="keyword">module</span> <a href="Header/index.html">Header</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Question"><a href="#module-Question" class="anchor"></a><code><span class="keyword">module</span> <a href="Question/index.html">Question</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Query"><a href="#module-Query" class="anchor"></a><code><span class="keyword">module</span> <a href="Query/index.html">Query</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Axfr"><a href="#module-Axfr" class="anchor"></a><code><span class="keyword">module</span> <a href="Axfr/index.html">Axfr</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Ixfr"><a href="#module-Ixfr" class="anchor"></a><code><span class="keyword">module</span> <a href="Ixfr/index.html">Ixfr</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Update"><a href="#module-Update" class="anchor"></a><code><span class="keyword">module</span> <a href="Update/index.html">Update</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec type" id="type-request"><a href="#type-request" class="anchor"></a><code><span class="keyword">type</span> request</code> = <code>[ </code><table class="variant"><tr id="type-request.Query" class="anchored"><td class="def constructor"><a href="#type-request.Query" class="anchor"></a><code>| </code><code>`Query</code></td></tr><tr id="type-request.Notify" class="anchored"><td class="def constructor"><a href="#type-request.Notify" class="anchor"></a><code>| </code><code>`Notify <span class="keyword">of</span> <a href="../Soa/index.html#type-t">Soa.t</a> option</code></td></tr><tr id="type-request.Axfr_request" class="anchored"><td class="def constructor"><a href="#type-request.Axfr_request" class="anchor"></a><code>| </code><code>`Axfr_request</code></td></tr><tr id="type-request.Ixfr_request" class="anchored"><td class="def constructor"><a href="#type-request.Ixfr_request" class="anchor"></a><code>| </code><code>`Ixfr_request <span class="keyword">of</span> <a href="../Soa/index.html#type-t">Soa.t</a></code></td></tr><tr id="type-request.Update" class="anchored"><td class="def constructor"><a href="#type-request.Update" class="anchor"></a><code>| </code><code>`Update <span class="keyword">of</span> <a href="Update/index.html#type-t">Update.t</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-equal_request"><a href="#val-equal_request" class="anchor"></a><code><span class="keyword">val</span> equal_request : <a href="index.html#type-request">request</a> <span>&#45;&gt;</span> <a href="index.html#type-request">request</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-pp_request"><a href="#val-pp_request" class="anchor"></a><code><span class="keyword">val</span> pp_request : <a href="index.html#type-request">request</a> Fmt.t</code></dt></dl><dl><dt class="spec type" id="type-reply"><a href="#type-reply" class="anchor"></a><code><span class="keyword">type</span> reply</code> = <code>[ </code><table class="variant"><tr id="type-reply.Answer" class="anchored"><td class="def constructor"><a href="#type-reply.Answer" class="anchor"></a><code>| </code><code>`Answer <span class="keyword">of</span> <a href="Query/index.html#type-t">Query.t</a></code></td></tr><tr id="type-reply.Notify_ack" class="anchored"><td class="def constructor"><a href="#type-reply.Notify_ack" class="anchor"></a><code>| </code><code>`Notify_ack</code></td></tr><tr id="type-reply.Axfr_reply" class="anchored"><td class="def constructor"><a href="#type-reply.Axfr_reply" class="anchor"></a><code>| </code><code>`Axfr_reply <span class="keyword">of</span> <a href="Axfr/index.html#type-t">Axfr.t</a></code></td></tr><tr id="type-reply.Ixfr_reply" class="anchored"><td class="def constructor"><a href="#type-reply.Ixfr_reply" class="anchor"></a><code>| </code><code>`Ixfr_reply <span class="keyword">of</span> <a href="Ixfr/index.html#type-t">Ixfr.t</a></code></td></tr><tr id="type-reply.Update_ack" class="anchored"><td class="def constructor"><a href="#type-reply.Update_ack" class="anchor"></a><code>| </code><code>`Update_ack</code></td></tr><tr id="type-reply.Rcode_error" class="anchored"><td class="def constructor"><a href="#type-reply.Rcode_error" class="anchor"></a><code>| </code><code>`Rcode_error <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a> * <a href="../Opcode/index.html#type-t">Opcode.t</a> * <a href="Query/index.html#type-t">Query.t</a> option</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-equal_reply"><a href="#val-equal_reply" class="anchor"></a><code><span class="keyword">val</span> equal_reply : <a href="index.html#type-reply">reply</a> <span>&#45;&gt;</span> <a href="index.html#type-reply">reply</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-pp_reply"><a href="#val-pp_reply" class="anchor"></a><code><span class="keyword">val</span> pp_reply : <a href="index.html#type-reply">reply</a> Fmt.t</code></dt></dl><dl><dt class="spec type" id="type-data"><a href="#type-data" class="anchor"></a><code><span class="keyword">type</span> data</code> = <code>[ </code><table class="variant"><tr id="type-data.request" class="anchored"><td class="def type"><a href="#type-data.request" class="anchor"></a><code>| </code><code><a href="index.html#type-request">request</a></code></td></tr><tr id="type-data.reply" class="anchored"><td class="def type"><a href="#type-data.reply" class="anchor"></a><code>| </code><code><a href="index.html#type-reply">reply</a></code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-opcode_data"><a href="#val-opcode_data" class="anchor"></a><code><span class="keyword">val</span> opcode_data : <a href="index.html#type-data">data</a> <span>&#45;&gt;</span> <a href="../Opcode/index.html#type-t">Opcode.t</a></code></dt><dt class="spec value" id="val-rcode_data"><a href="#val-rcode_data" class="anchor"></a><code><span class="keyword">val</span> rcode_data : <a href="index.html#type-data">data</a> <span>&#45;&gt;</span> <a href="../Rcode/index.html#type-t">Rcode.t</a></code></dt><dt class="spec value" id="val-equal_data"><a href="#val-equal_data" class="anchor"></a><code><span class="keyword">val</span> equal_data : <a href="index.html#type-data">data</a> <span>&#45;&gt;</span> <a href="index.html#type-data">data</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-pp_data"><a href="#val-pp_data" class="anchor"></a><code><span class="keyword">val</span> pp_data : <a href="index.html#type-data">data</a> Fmt.t</code></dt></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <span class="keyword">private</span> </code><code>{</code><table class="record"><tr id="type-t.header" class="anchored"><td class="def field"><a href="#type-t.header" class="anchor"></a><code>header : <a href="Header/index.html#type-t">Header.t</a>;</code></td></tr><tr id="type-t.question" class="anchored"><td class="def field"><a href="#type-t.question" class="anchor"></a><code>question : <a href="Question/index.html#type-t">Question.t</a>;</code></td></tr><tr id="type-t.data" class="anchored"><td class="def field"><a href="#type-t.data" class="anchor"></a><code>data : <a href="index.html#type-data">data</a>;</code></td></tr><tr id="type-t.additional" class="anchored"><td class="def field"><a href="#type-t.additional" class="anchor"></a><code>additional : <a href="../Name_rr_map/index.html#type-t">Name_rr_map.t</a>;</code></td></tr><tr id="type-t.edns" class="anchored"><td class="def field"><a href="#type-t.edns" class="anchor"></a><code>edns : <a href="../Edns/index.html#type-t">Edns.t</a> option;</code></td></tr><tr id="type-t.tsig" class="anchored"><td class="def field"><a href="#type-t.tsig" class="anchor"></a><code>tsig : (Domain_name.t * <a href="../Tsig/index.html#type-t">Tsig.t</a> * int) option;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : ?&#8288;max_size:int <span>&#45;&gt;</span> ?&#8288;additional:<a href="../Name_rr_map/index.html#type-t">Name_rr_map.t</a> <span>&#45;&gt;</span> ?&#8288;edns:<a href="../Edns/index.html#type-t">Edns.t</a> <span>&#45;&gt;</span> <a href="Header/index.html#type-t">Header.t</a> <span>&#45;&gt;</span> <a href="Question/index.html#type-t">Question.t</a> <span>&#45;&gt;</span> <a href="index.html#type-data">data</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-with_edns"><a href="#val-with_edns" class="anchor"></a><code><span class="keyword">val</span> with_edns : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Edns/index.html#type-t">Edns.t</a> option <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="index.html#type-t">t</a> Fmt.t</code></dt><dt class="spec value" id="val-pp_header"><a href="#val-pp_header" class="anchor"></a><code><span class="keyword">val</span> pp_header : <a href="index.html#type-t">t</a> Fmt.t</code></dt><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt></dl><dl><dt class="spec type" id="type-err"><a href="#type-err" class="anchor"></a><code><span class="keyword">type</span> err</code> = <code>[ </code><table class="variant"><tr id="type-err.Bad_edns_version" class="anchored"><td class="def constructor"><a href="#type-err.Bad_edns_version" class="anchor"></a><code>| </code><code>`Bad_edns_version <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Leftover" class="anchored"><td class="def constructor"><a href="#type-err.Leftover" class="anchor"></a><code>| </code><code>`Leftover <span class="keyword">of</span> int * string</code></td></tr><tr id="type-err.Malformed" class="anchored"><td class="def constructor"><a href="#type-err.Malformed" class="anchor"></a><code>| </code><code>`Malformed <span class="keyword">of</span> int * string</code></td></tr><tr id="type-err.Not_implemented" class="anchored"><td class="def constructor"><a href="#type-err.Not_implemented" class="anchor"></a><code>| </code><code>`Not_implemented <span class="keyword">of</span> int * string</code></td></tr><tr id="type-err.Notify_ack_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_ack_answer_count" class="anchor"></a><code>| </code><code>`Notify_ack_answer_count <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Notify_ack_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_ack_authority_count" class="anchor"></a><code>| </code><code>`Notify_ack_authority_count <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Notify_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_answer_count" class="anchor"></a><code>| </code><code>`Notify_answer_count <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Notify_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_authority_count" class="anchor"></a><code>| </code><code>`Notify_authority_count <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Partial" class="anchored"><td class="def constructor"><a href="#type-err.Partial" class="anchor"></a><code>| </code><code>`Partial</code></td></tr><tr id="type-err.Query_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Query_answer_count" class="anchor"></a><code>| </code><code>`Query_answer_count <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Query_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Query_authority_count" class="anchor"></a><code>| </code><code>`Query_authority_count <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Rcode_cant_change" class="anchored"><td class="def constructor"><a href="#type-err.Rcode_cant_change" class="anchor"></a><code>| </code><code>`Rcode_cant_change <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a></code></td></tr><tr id="type-err.Rcode_error_cant_noerror" class="anchored"><td class="def constructor"><a href="#type-err.Rcode_error_cant_noerror" class="anchor"></a><code>| </code><code>`Rcode_error_cant_noerror <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a></code></td></tr><tr id="type-err.Request_rcode" class="anchored"><td class="def constructor"><a href="#type-err.Request_rcode" class="anchor"></a><code>| </code><code>`Request_rcode <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a></code></td></tr><tr id="type-err.Truncated_request" class="anchored"><td class="def constructor"><a href="#type-err.Truncated_request" class="anchor"></a><code>| </code><code>`Truncated_request</code></td></tr><tr id="type-err.Update_ack_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Update_ack_answer_count" class="anchor"></a><code>| </code><code>`Update_ack_answer_count <span class="keyword">of</span> int</code></td></tr><tr id="type-err.Update_ack_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Update_ack_authority_count" class="anchor"></a><code>| </code><code>`Update_ack_authority_count <span class="keyword">of</span> int</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_err"><a href="#val-pp_err" class="anchor"></a><code><span class="keyword">val</span> pp_err : <a href="index.html#type-err">err</a> Fmt.t</code></dt><dt class="spec value" id="val-decode"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : Cstruct.t <span>&#45;&gt;</span> (<a href="index.html#type-t">t</a>, <a href="index.html#type-err">err</a>) Stdlib.result</code></dt></dl><dl><dt class="spec type" id="type-mismatch"><a href="#type-mismatch" class="anchor"></a><code><span class="keyword">type</span> mismatch</code> = <code>[ </code><table class="variant"><tr id="type-mismatch.Not_a_reply" class="anchored"><td class="def constructor"><a href="#type-mismatch.Not_a_reply" class="anchor"></a><code>| </code><code>`Not_a_reply <span class="keyword">of</span> <a href="index.html#type-request">request</a></code></td></tr><tr id="type-mismatch.Id_mismatch" class="anchored"><td class="def constructor"><a href="#type-mismatch.Id_mismatch" class="anchor"></a><code>| </code><code>`Id_mismatch <span class="keyword">of</span> int * int</code></td></tr><tr id="type-mismatch.Operation_mismatch" class="anchored"><td class="def constructor"><a href="#type-mismatch.Operation_mismatch" class="anchor"></a><code>| </code><code>`Operation_mismatch <span class="keyword">of</span> <a href="index.html#type-request">request</a> * <a href="index.html#type-reply">reply</a></code></td></tr><tr id="type-mismatch.Question_mismatch" class="anchored"><td class="def constructor"><a href="#type-mismatch.Question_mismatch" class="anchor"></a><code>| </code><code>`Question_mismatch <span class="keyword">of</span> <a href="Question/index.html#type-t">Question.t</a> * <a href="Question/index.html#type-t">Question.t</a></code></td></tr><tr id="type-mismatch.Expected_request" class="anchored"><td class="def constructor"><a href="#type-mismatch.Expected_request" class="anchor"></a><code>| </code><code>`Expected_request</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-pp_mismatch"><a href="#val-pp_mismatch" class="anchor"></a><code><span class="keyword">val</span> pp_mismatch : <a href="index.html#type-mismatch">mismatch</a> Fmt.t</code></dt><dt class="spec value" id="val-reply_matches_request"><a href="#val-reply_matches_request" class="anchor"></a><code><span class="keyword">val</span> reply_matches_request : request:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="index.html#type-reply">reply</a>, <a href="index.html#type-mismatch">mismatch</a>) Stdlib.result</code></dt><dd><p><code>reply_matches_request ~request reply</code> validates that the <code>reply</code> match the <code>request</code>, and returns either <code>Ok data</code> or an <code>Error</code>. The following basic checks are performed:</p><ul><li>Is the header identifier of <code>request</code> and <code>reply</code> equal?</li><li>Does the <code>request</code> operation match the <code>reply</code> operation?</li><li>Is <code>question</code> and the question of <code>response</code> equal?</li></ul></dd></dl><dl><dt class="spec value" id="val-size_edns"><a href="#val-size_edns" class="anchor"></a><code><span class="keyword">val</span> size_edns : int option <span>&#45;&gt;</span> <a href="../Edns/index.html#type-t">Edns.t</a> option <span>&#45;&gt;</span> <a href="../index.html#type-proto">proto</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> int * <a href="../Edns/index.html#type-t">Edns.t</a> option</code></dt><dt class="spec value" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val</span> encode : ?&#8288;max_size:int <span>&#45;&gt;</span> <a href="../index.html#type-proto">proto</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Cstruct.t * int</code></dt><dt class="spec value" id="val-raw_error"><a href="#val-raw_error" class="anchor"></a><code><span class="keyword">val</span> raw_error : Cstruct.t <span>&#45;&gt;</span> <a href="../Rcode/index.html#type-t">Rcode.t</a> <span>&#45;&gt;</span> Cstruct.t option</code></dt></dl></div></body></html>