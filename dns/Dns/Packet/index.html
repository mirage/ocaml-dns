<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Packet (dns.Dns.Packet)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">dns</a> &#x00BB; <a href="../index.html">Dns</a> &#x00BB; Packet</nav><header class="odoc-preamble"><h1>Module <code><span>Dns.Packet</span></code></h1><p>The DNS packet.</p><p>Encoding and decoding from binary. Definition of types for multiple DNS operations.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-Flag" class="anchored"><a href="#module-Flag" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Flag/index.html">Flag</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Flags" class="anchored"><a href="#module-Flags" class="anchor"></a><code><span><span class="keyword">module</span> Flags</span><span> : <span class="xref-unresolved">Stdlib</span>.Set.S <span class="keyword">with</span> <span><span class="keyword">type</span> <span class="xref-unresolved">elt</span> = <span class="xref-unresolved">Flag</span>.t</span></span></code></div><div class="spec-doc"><p>The set of flags</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Header" class="anchored"><a href="#module-Header" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Header/index.html">Header</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A DNS header</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Question" class="anchored"><a href="#module-Question" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Question/index.html">Question</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A DNS Question - the first section of a DNS packet</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Answer" class="anchored"><a href="#module-Answer" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Answer/index.html">Answer</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A DNS answer, consisting of the answer and authority sections.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Axfr" class="anchored"><a href="#module-Axfr" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Axfr/index.html">Axfr</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A DNS zone transfer.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Ixfr" class="anchored"><a href="#module-Ixfr" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Ixfr/index.html">Ixfr</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Incremental DNS zone transfer.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Update" class="anchored"><a href="#module-Update" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Update/index.html">Update</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>DNS update packets.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-request" class="anchored"><a href="#type-request" class="anchor"></a><code><span><span class="keyword">type</span> request</span><span> = </span><span>[ </span></code><table><tr id="type-request.Query" class="anchored"><td class="def constructor"><a href="#type-request.Query" class="anchor"></a><code><span>| </span></code><code><span>`Query</span></code></td></tr><tr id="type-request.Notify" class="anchored"><td class="def constructor"><a href="#type-request.Notify" class="anchor"></a><code><span>| </span></code><code><span>`Notify <span class="keyword">of</span> <span><a href="../Soa/index.html#type-t">Soa.t</a> option</span></span></code></td></tr><tr id="type-request.Axfr_request" class="anchored"><td class="def constructor"><a href="#type-request.Axfr_request" class="anchor"></a><code><span>| </span></code><code><span>`Axfr_request</span></code></td></tr><tr id="type-request.Ixfr_request" class="anchored"><td class="def constructor"><a href="#type-request.Ixfr_request" class="anchor"></a><code><span>| </span></code><code><span>`Ixfr_request <span class="keyword">of</span> <a href="../Soa/index.html#type-t">Soa.t</a></span></code></td></tr><tr id="type-request.Update" class="anchored"><td class="def constructor"><a href="#type-request.Update" class="anchor"></a><code><span>| </span></code><code><span>`Update <span class="keyword">of</span> <a href="Update/index.html#type-t">Update.t</a></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type of a DNS request: depending on opcode and rr_typ.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-equal_request" class="anchored"><a href="#val-equal_request" class="anchor"></a><code><span><span class="keyword">val</span> equal_request : <span><a href="#type-request">request</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-request">request</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal_request a b</code> is <code>true</code> if the request <code>a</code> is the same as <code>b</code>, <code>false</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_request" class="anchored"><a href="#val-pp_request" class="anchor"></a><code><span><span class="keyword">val</span> pp_request : <span><a href="#type-request">request</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_request ppf r</code> pretty-prints the request <code>r</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-reply" class="anchored"><a href="#type-reply" class="anchor"></a><code><span><span class="keyword">type</span> reply</span><span> = </span><span>[ </span></code><table><tr id="type-reply.Answer" class="anchored"><td class="def constructor"><a href="#type-reply.Answer" class="anchor"></a><code><span>| </span></code><code><span>`Answer <span class="keyword">of</span> <a href="Answer/index.html#type-t">Answer.t</a></span></code></td></tr><tr id="type-reply.Notify_ack" class="anchored"><td class="def constructor"><a href="#type-reply.Notify_ack" class="anchor"></a><code><span>| </span></code><code><span>`Notify_ack</span></code></td></tr><tr id="type-reply.Axfr_reply" class="anchored"><td class="def constructor"><a href="#type-reply.Axfr_reply" class="anchor"></a><code><span>| </span></code><code><span>`Axfr_reply <span class="keyword">of</span> <a href="Axfr/index.html#type-t">Axfr.t</a></span></code></td></tr><tr id="type-reply.Axfr_partial_reply" class="anchored"><td class="def constructor"><a href="#type-reply.Axfr_partial_reply" class="anchor"></a><code><span>| </span></code><code><span>`Axfr_partial_reply <span class="keyword">of</span>
  <span>[ <span>`First of <a href="../Soa/index.html#type-t">Soa.t</a></span> <span>| `Mid</span> <span><span>| `Last</span> of <a href="../Soa/index.html#type-t">Soa.t</a></span> ]</span> * <a href="../Name_rr_map/index.html#type-t">Name_rr_map.t</a></span></code></td></tr><tr id="type-reply.Ixfr_reply" class="anchored"><td class="def constructor"><a href="#type-reply.Ixfr_reply" class="anchor"></a><code><span>| </span></code><code><span>`Ixfr_reply <span class="keyword">of</span> <a href="Ixfr/index.html#type-t">Ixfr.t</a></span></code></td></tr><tr id="type-reply.Update_ack" class="anchored"><td class="def constructor"><a href="#type-reply.Update_ack" class="anchor"></a><code><span>| </span></code><code><span>`Update_ack</span></code></td></tr><tr id="type-reply.Rcode_error" class="anchored"><td class="def constructor"><a href="#type-reply.Rcode_error" class="anchor"></a><code><span>| </span></code><code><span>`Rcode_error <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a> * <a href="../Opcode/index.html#type-t">Opcode.t</a> * <span><a href="Answer/index.html#type-t">Answer.t</a> option</span></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type of a DNS reply: depending on opcode, rr_typ, and rcode.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-equal_reply" class="anchored"><a href="#val-equal_reply" class="anchor"></a><code><span><span class="keyword">val</span> equal_reply : <span><a href="#type-reply">reply</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-reply">reply</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal_reply a b</code> is <code>true</code> if the reply <code>a</code> is the same as <code>b</code>, <code>false</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_reply" class="anchored"><a href="#val-pp_reply" class="anchor"></a><code><span><span class="keyword">val</span> pp_reply : <span><a href="#type-reply">reply</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_reply ppf r</code> pretty-prints the reply <code>r</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-data" class="anchored"><a href="#type-data" class="anchor"></a><code><span><span class="keyword">type</span> data</span><span> = </span><span>[ </span></code><table><tr id="type-data.request" class="anchored"><td class="def type"><a href="#type-data.request" class="anchor"></a><code><span>| </span></code><code><span><a href="#type-request">request</a></span></code></td></tr><tr id="type-data.reply" class="anchored"><td class="def type"><a href="#type-data.reply" class="anchor"></a><code><span>| </span></code><code><span><a href="#type-reply">reply</a></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type of either request or reply.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-opcode_data" class="anchored"><a href="#val-opcode_data" class="anchor"></a><code><span><span class="keyword">val</span> opcode_data : <span><a href="#type-data">data</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Opcode/index.html#type-t">Opcode.t</a></span></code></div><div class="spec-doc"><p><code>opcode_data data</code> is the opcode of <code>data</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-rcode_data" class="anchored"><a href="#val-rcode_data" class="anchor"></a><code><span><span class="keyword">val</span> rcode_data : <span><a href="#type-data">data</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Rcode/index.html#type-t">Rcode.t</a></span></code></div><div class="spec-doc"><p><code>rcode_data data</code> is the response code of <code>data</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-equal_data" class="anchored"><a href="#val-equal_data" class="anchor"></a><code><span><span class="keyword">val</span> equal_data : <span><a href="#type-data">data</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-data">data</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal_data a b</code> is <code>true</code> if <code>a</code> and <code>b</code> are the same, <code>false</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_data" class="anchored"><a href="#val-pp_data" class="anchor"></a><code><span><span class="keyword">val</span> pp_data : <span><a href="#type-data">data</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_data ppf data</code> pretty-prints <code>data</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <span class="keyword">private</span> </span><span>{</span></code><table><tr id="type-t.header" class="anchored"><td class="def record field"><a href="#type-t.header" class="anchor"></a><code><span>header : <a href="Header/index.html#type-t">Header.t</a>;</span></code></td></tr><tr id="type-t.question" class="anchored"><td class="def record field"><a href="#type-t.question" class="anchor"></a><code><span>question : <a href="Question/index.html#type-t">Question.t</a>;</span></code></td></tr><tr id="type-t.data" class="anchored"><td class="def record field"><a href="#type-t.data" class="anchor"></a><code><span>data : <a href="#type-data">data</a>;</span></code></td></tr><tr id="type-t.additional" class="anchored"><td class="def record field"><a href="#type-t.additional" class="anchor"></a><code><span>additional : <a href="../Name_rr_map/index.html#type-t">Name_rr_map.t</a>;</span></code></td></tr><tr id="type-t.edns" class="anchored"><td class="def record field"><a href="#type-t.edns" class="anchor"></a><code><span>edns : <span><a href="../Edns/index.html#type-t">Edns.t</a> option</span>;</span></code></td></tr><tr id="type-t.tsig" class="anchored"><td class="def record field"><a href="#type-t.tsig" class="anchor"></a><code><span>tsig : <span><span>(<span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <a href="../Tsig/index.html#type-t">Tsig.t</a> * int)</span> option</span>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>The type of a DNS packet: its header, question, data, additional section, and optional EDNS and TSIG records.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?max_size:int <span class="arrow">&#45;&gt;</span></span>
  <span>?additional:<a href="../Name_rr_map/index.html#type-t">Name_rr_map.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?edns:<a href="../Edns/index.html#type-t">Edns.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?tsig:<span>(<span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <a href="../Tsig/index.html#type-t">Tsig.t</a> * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Header/index.html#type-t">Header.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Question/index.html#type-t">Question.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-data">data</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create ~max_size ~additional ~edns ~tsig hdr q data</code> is a DNS packet.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_edns" class="anchored"><a href="#val-with_edns" class="anchor"></a><code><span><span class="keyword">val</span> with_edns : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../Edns/index.html#type-t">Edns.t</a> option</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>with_edns t edns</code> is <code>t</code> with the edns field set to <code>edns</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><a href="#type-t">t</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp ppf t</code> pretty-prints the DNS packet <code>t</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_header" class="anchored"><a href="#val-pp_header" class="anchor"></a><code><span><span class="keyword">val</span> pp_header : <span><a href="#type-t">t</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_header ppf t</code> pretty-prints the header of the DNS packet on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-equal" class="anchored"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal a b</code> is <code>true</code> if the DNS packet <code>a</code> and <code>b</code> are equal, <code>false</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-err" class="anchored"><a href="#type-err" class="anchor"></a><code><span><span class="keyword">type</span> err</span><span> = </span><span>[ </span></code><table><tr id="type-err.Bad_edns_version" class="anchored"><td class="def constructor"><a href="#type-err.Bad_edns_version" class="anchor"></a><code><span>| </span></code><code><span>`Bad_edns_version <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Leftover" class="anchored"><td class="def constructor"><a href="#type-err.Leftover" class="anchor"></a><code><span>| </span></code><code><span>`Leftover <span class="keyword">of</span> int * string</span></code></td></tr><tr id="type-err.Malformed" class="anchored"><td class="def constructor"><a href="#type-err.Malformed" class="anchor"></a><code><span>| </span></code><code><span>`Malformed <span class="keyword">of</span> int * string</span></code></td></tr><tr id="type-err.Not_implemented" class="anchored"><td class="def constructor"><a href="#type-err.Not_implemented" class="anchor"></a><code><span>| </span></code><code><span>`Not_implemented <span class="keyword">of</span> int * string</span></code></td></tr><tr id="type-err.Notify_ack_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_ack_answer_count" class="anchor"></a><code><span>| </span></code><code><span>`Notify_ack_answer_count <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Notify_ack_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_ack_authority_count" class="anchor"></a><code><span>| </span></code><code><span>`Notify_ack_authority_count <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Notify_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_answer_count" class="anchor"></a><code><span>| </span></code><code><span>`Notify_answer_count <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Notify_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Notify_authority_count" class="anchor"></a><code><span>| </span></code><code><span>`Notify_authority_count <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Partial" class="anchored"><td class="def constructor"><a href="#type-err.Partial" class="anchor"></a><code><span>| </span></code><code><span>`Partial</span></code></td></tr><tr id="type-err.Query_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Query_answer_count" class="anchor"></a><code><span>| </span></code><code><span>`Query_answer_count <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Query_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Query_authority_count" class="anchor"></a><code><span>| </span></code><code><span>`Query_authority_count <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Rcode_cant_change" class="anchored"><td class="def constructor"><a href="#type-err.Rcode_cant_change" class="anchor"></a><code><span>| </span></code><code><span>`Rcode_cant_change <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a></span></code></td></tr><tr id="type-err.Rcode_error_cant_noerror" class="anchored"><td class="def constructor"><a href="#type-err.Rcode_error_cant_noerror" class="anchor"></a><code><span>| </span></code><code><span>`Rcode_error_cant_noerror <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a></span></code></td></tr><tr id="type-err.Request_rcode" class="anchored"><td class="def constructor"><a href="#type-err.Request_rcode" class="anchor"></a><code><span>| </span></code><code><span>`Request_rcode <span class="keyword">of</span> <a href="../Rcode/index.html#type-t">Rcode.t</a></span></code></td></tr><tr id="type-err.Truncated_request" class="anchored"><td class="def constructor"><a href="#type-err.Truncated_request" class="anchor"></a><code><span>| </span></code><code><span>`Truncated_request</span></code></td></tr><tr id="type-err.Update_ack_answer_count" class="anchored"><td class="def constructor"><a href="#type-err.Update_ack_answer_count" class="anchor"></a><code><span>| </span></code><code><span>`Update_ack_answer_count <span class="keyword">of</span> int</span></code></td></tr><tr id="type-err.Update_ack_authority_count" class="anchored"><td class="def constructor"><a href="#type-err.Update_ack_authority_count" class="anchor"></a><code><span>| </span></code><code><span>`Update_ack_authority_count <span class="keyword">of</span> int</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type of decode errors.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_err" class="anchored"><a href="#val-pp_err" class="anchor"></a><code><span><span class="keyword">val</span> pp_err : <span><a href="#type-err">err</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_err ppf err</code> pretty-prints the decode error <code>err</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-decode" class="anchored"><a href="#val-decode" class="anchor"></a><code><span><span class="keyword">val</span> decode : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span>( <a href="#type-t">t</a>, <a href="#type-err">err</a> )</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>decode cs</code> decode the binary data <code>cs</code> to a DNS packet <code>t</code> or an error.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-mismatch" class="anchored"><a href="#type-mismatch" class="anchor"></a><code><span><span class="keyword">type</span> mismatch</span><span> = </span><span>[ </span></code><table><tr id="type-mismatch.Not_a_reply" class="anchored"><td class="def constructor"><a href="#type-mismatch.Not_a_reply" class="anchor"></a><code><span>| </span></code><code><span>`Not_a_reply <span class="keyword">of</span> <a href="#type-request">request</a></span></code></td></tr><tr id="type-mismatch.Id_mismatch" class="anchored"><td class="def constructor"><a href="#type-mismatch.Id_mismatch" class="anchor"></a><code><span>| </span></code><code><span>`Id_mismatch <span class="keyword">of</span> int * int</span></code></td></tr><tr id="type-mismatch.Operation_mismatch" class="anchored"><td class="def constructor"><a href="#type-mismatch.Operation_mismatch" class="anchor"></a><code><span>| </span></code><code><span>`Operation_mismatch <span class="keyword">of</span> <a href="#type-request">request</a> * <a href="#type-reply">reply</a></span></code></td></tr><tr id="type-mismatch.Question_mismatch" class="anchored"><td class="def constructor"><a href="#type-mismatch.Question_mismatch" class="anchor"></a><code><span>| </span></code><code><span>`Question_mismatch <span class="keyword">of</span> <a href="Question/index.html#type-t">Question.t</a> * <a href="Question/index.html#type-t">Question.t</a></span></code></td></tr><tr id="type-mismatch.Expected_request" class="anchored"><td class="def constructor"><a href="#type-mismatch.Expected_request" class="anchor"></a><code><span>| </span></code><code><span>`Expected_request</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type of request / reply mismatches.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_mismatch" class="anchored"><a href="#val-pp_mismatch" class="anchor"></a><code><span><span class="keyword">val</span> pp_mismatch : <span><a href="#type-mismatch">mismatch</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_mismatch ppf m</code> pretty-prints the mismatch <code>m</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-reply_matches_request" class="anchored"><a href="#val-reply_matches_request" class="anchor"></a><code><span><span class="keyword">val</span> reply_matches_request : <span>request:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <a href="#type-reply">reply</a>, <a href="#type-mismatch">mismatch</a> )</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>reply_matches_request ~request reply</code> validates that the <code>reply</code> match the <code>request</code>, and returns either <code>Ok data</code> or an <code>Error</code>. The following basic checks are performed:</p><ul><li>Is the header identifier of <code>request</code> and <code>reply</code> equal?</li><li>Does the <code>request</code> operation match the <code>reply</code> operation?</li><li>Is <code>question</code> and the question of <code>response</code> equal?</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-size_edns" class="anchored"><a href="#val-size_edns" class="anchor"></a><code><span><span class="keyword">val</span> size_edns : 
  <span><span>int option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Edns/index.html#type-t">Edns.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-proto">proto</a> <span class="arrow">&#45;&gt;</span></span>
  <span>bool <span class="arrow">&#45;&gt;</span></span>
  int * <span><a href="../Edns/index.html#type-t">Edns.t</a> option</span></span></code></div><div class="spec-doc"><p><code>size_edns max_size edns protocol query</code> computes the size of the reply packet, and optionally an EDNS record.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-encode" class="anchored"><a href="#val-encode" class="anchor"></a><code><span><span class="keyword">val</span> encode : <span>?max_size:int <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-proto">proto</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t * int</span></code></div><div class="spec-doc"><p><code>encode ~max_size protocol t</code> allocates a buffer and encodes the DNS packet <code>t</code> into it. If the maximum size (depending on <code>max_size</code> and <code>protocol</code>) is reached, the truncation flag is set. The last component of the result is the maximum size.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-encode_axfr_reply" class="anchored"><a href="#val-encode_axfr_reply" class="anchor"></a><code><span><span class="keyword">val</span> encode_axfr_reply : 
  <span>?max_size:int <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-proto">proto</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Axfr/index.html#type-t">Axfr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Cstruct</span>.t list</span> * int</span></code></div><div class="spec-doc"><p><code>encode_axfr_reply ~max_size tsig_size protocol t axfr</code> encodes the <code>axfr</code> into a list of buffers to be sent out (each with at least <code>tsig_size</code> space for a tsig signature. The second component of the result is the maximum size (dependent on <code>max_size</code> and <code>protocol</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-raw_error" class="anchored"><a href="#val-raw_error" class="anchor"></a><code><span><span class="keyword">val</span> raw_error : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="../Rcode/index.html#type-t">Rcode.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Cstruct</span>.t option</span></span></code></div><div class="spec-doc"><p><code>raw_error cs rcode</code> is an error reply with <code>rcode</code> to <code>cs</code>, or None if <code>cs</code> is already a reply.</p></div></div></div></body></html>