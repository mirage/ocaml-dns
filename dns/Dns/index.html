<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dns (dns.Dns)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../index.html">dns</a> &#x00BB; Dns</nav><header class="odoc-preamble"><h1>Module <code><span>Dns</span></code></h1><p>µDNS - an opinionated Domain Name System (DNS) library</p><p>The Domain Name System is a hierarchical and decentralized naming system used on the Internet. It associates domain names with nearly arbitrary information. Best known is the translation of easily memoizable domain names to numerical IP addresses, which are used by computers for establishing communication channels - so called <a href="A/index.html">address</a> records. DNS has been deployed since 1985 on the Internet. It is a widely deployed, fault-tolerant, distributed key-value store with built-in caching mechanisms. The keys are <span class="xref-unresolved">domain names</span> and <a href="Rr_map/index.html#type-k">record types</a>, the values are <a href="Rr_map/index.html#type-rr">record sets</a>. Each record set has a time-to-live associated with it: the maximum time this entry may be cached. The <a href="https://github.com/hannesm/domain-name">domain name</a> library provides operations on domain names. Hostnames are domain names with further restrictions: Only letters, digits, and hyphen are allowed. Domain name comparison is usually done ignoring the case.</p><p>A set of 13 authoritative name servers form the root zone which delegate authority for subdomains to registrars (using country codes, etc.), which delegate domains to individuals who host their Internet presence there.</p><p>The delegation mechanism utilizes the DNS protocol itself, using <a href="Ns/index.html">name server</a> records, and <a href="Soa/index.html">start of authority</a> records. The globally federated eMail system uses <a href="Mx/index.html">mail exchange</a> records.</p><p>Each Internet domain has at least two authoritative name servers registered to enable fault tolerance. To keep these synchronised, a zone transfer mechanism is part of DNS. In-protocol DNS extension mechanisms include dynamic updates, authentication, and notifications, which allow arbitrary synchronized, authenticated modifications.</p><p>From a client perspective, the C library functions <code>gethostbyname</code> or <code>getaddrinfo</code> are mainly used, which receive a string (and a record type) and return a reply. A client requests a caching recursive resolver hosted close to the client - e.g. at their ISP, and awaits an answer. The recursive resolver iterates over the domain name parts, and requests the registered authoritative name servers, until the name server responsible for the requested domain name is found.</p><p>The core µDNS library includes type definitions of supported record types, decoding and encoding thereof to the binary protocol used on the Internet, also serialising and parsing of the standardized text form. The record types and their values are defined by the <a href="Rr_map/index.html#type-k">key</a> type, which has for each record type a specific value type, using a generalized algebraic data type -- i.e. an address record may only contain a time-to-live and a set of IPv4 addresses. This is used to construct a <span class="xref-unresolved">map</span> data structure.</p><p>This core µDNS library is used by various DNS components:</p><ul><li><code>Dns_tsig</code> implements TSIG authentication</li><li><code>Dns_server</code> implements an authoritative server</li><li><code>Dns_client</code> implements a client</li><li><code>Dns_zone</code> implements a zone file parser</li><li><code>Dns_resolver</code> implements a recursive resolver</li></ul><p>These core libraries are pure, i.e. it is independent of network communnication, uses immutable values, and errors are explicit as <code>result</code> type. Timestamps are passed in to the main handle functions. Some components, such as a secondary server, which needs to check freshness of its data in regular intervals. The logic is implemented and exposed as function, which needs to be called from a side-effecting layer.</p><p>For the client library, several side-effecting layers are implemented: <code>dns-client.unix</code> uses the blocking <code>Unix</code> API (distributed with the OCaml runtime), <code>dns-client.lwt</code> uses the non-blocking <code>Lwt</code> API, and <code>dns-client.mirage</code> using MirageOS interfaces. Unix command line utilities are provided in the <code>dns-cli</code> package.</p><p>For the server and resolver components, side-effecting implementations using MirageOS interfaces are provided in <code>dns-server.mirage</code> and <code>dns-resolver.mirage</code>. <a href="https://github.com/roburio/unikernels">Example unikernels</a> are provided externally, including authoritative primary and secondary servers, recursive and stub resolvers. The certificate authority <a href="https://letsencrypt">Let's Encrypt</a> implements a protocol (ACME) which automatically provisions X.509 certificates (which are trusted by common web browsers); one of the methods to produce proof of ownership is with a DNS <a href="Txt/index.html">TXT</a> record. Together with <a href="https://github.com/mmaker/ocaml-letsencrypt">ocaml-letsencrypt</a>, this DNS library can be used to provision certificate signing requests for the domain where you run an authoritative server. The certificate signing request and certificate are both stored as <a href="Tlsa/index.html">TLSA</a> records in DNS.</p><p><em>v6.4.0 - <a href="https://github.com/mirage/ocaml-dns">homepage</a></em></p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-proto" class="anchored"><a href="#type-proto" class="anchor"></a><code><span><span class="keyword">type</span> proto</span><span> = </span><span>[ </span></code><table><tr id="type-proto.Tcp" class="anchored"><td class="def constructor"><a href="#type-proto.Tcp" class="anchor"></a><code><span>| </span></code><code><span>`Tcp</span></code></td></tr><tr id="type-proto.Udp" class="anchored"><td class="def constructor"><a href="#type-proto.Udp" class="anchor"></a><code><span>| </span></code><code><span>`Udp</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type of supported protocols. Used by <a href="Packet/index.html#val-encode"><code>Packet.encode</code></a> to decide on maximum buffer length, etc.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-max_rdata_length" class="anchored"><a href="#val-max_rdata_length" class="anchor"></a><code><span><span class="keyword">val</span> max_rdata_length : int</span></code></div><div class="spec-doc"><p>Maximum size of resource data. This limitation is close to (2 ^ 16) - 1 (the limit of DNS-over-TCP and EDNS payload size, but slightly smaller, since an rdata must fit into this DNS message together with a DNS header, a question, and a TSIG signature (for e.g. zone transfer).</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Opcode" class="anchored"><a href="#module-Opcode" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Opcode/index.html">Opcode</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Opcode</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Rcode" class="anchored"><a href="#module-Rcode" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Rcode/index.html">Rcode</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Response code</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Soa" class="anchored"><a href="#module-Soa" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Soa/index.html">Soa</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Start of authority</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Ns" class="anchored"><a href="#module-Ns" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Ns/index.html">Ns</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Name server</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Mx" class="anchored"><a href="#module-Mx" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Mx/index.html">Mx</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Mail exchange</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Cname" class="anchored"><a href="#module-Cname" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Cname/index.html">Cname</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Canonical name</p></div></div><div class="odoc-spec"><div class="spec module" id="module-A" class="anchored"><a href="#module-A" class="anchor"></a><code><span><span class="keyword">module</span> <a href="A/index.html">A</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Adress record</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Aaaa" class="anchored"><a href="#module-Aaaa" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Aaaa/index.html">Aaaa</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Quad A record</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Ptr" class="anchored"><a href="#module-Ptr" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Ptr/index.html">Ptr</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Domain name pointer</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Srv" class="anchored"><a href="#module-Srv" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Srv/index.html">Srv</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Service record</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Dnskey" class="anchored"><a href="#module-Dnskey" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Dnskey/index.html">Dnskey</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>DNS keys</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Rrsig" class="anchored"><a href="#module-Rrsig" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Rrsig/index.html">Rrsig</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>RRSIG</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Ds" class="anchored"><a href="#module-Ds" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Ds/index.html">Ds</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>DS</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Bit_map" class="anchored"><a href="#module-Bit_map" class="anchor"></a><code><span><span class="keyword">module</span> Bit_map</span><span> : <span class="xref-unresolved">Stdlib</span>.Set.S <span class="keyword">with</span> <span><span class="keyword">type</span> <span class="xref-unresolved">elt</span> = <span class="xref-unresolved">int</span></span></span></code></div><div class="spec-doc"><p>Bit Map encodings of integers, used by NSEC and NSEC3.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Nsec" class="anchored"><a href="#module-Nsec" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Nsec/index.html">Nsec</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Nsec</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Nsec3" class="anchored"><a href="#module-Nsec3" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Nsec3/index.html">Nsec3</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Nsec3</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Caa" class="anchored"><a href="#module-Caa" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Caa/index.html">Caa</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Certificate authority authorization</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Tlsa" class="anchored"><a href="#module-Tlsa" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Tlsa/index.html">Tlsa</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Transport layer security authentication</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Sshfp" class="anchored"><a href="#module-Sshfp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Sshfp/index.html">Sshfp</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Secure shell fingerprint</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Txt" class="anchored"><a href="#module-Txt" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Txt/index.html">Txt</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Text records</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Tsig" class="anchored"><a href="#module-Tsig" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Tsig/index.html">Tsig</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Transaction signature</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Edns" class="anchored"><a href="#module-Edns" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Edns/index.html">Edns</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Extensions to DNS</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Loc" class="anchored"><a href="#module-Loc" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Loc/index.html">Loc</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Loc</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Rr_map" class="anchored"><a href="#module-Rr_map" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Rr_map/index.html">Rr_map</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A map whose keys are record types and their values are the time-to-live and the record set. The relation between key and value type is restricted by the below defined GADT.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Name_rr_map" class="anchored"><a href="#module-Name_rr_map" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Name_rr_map/index.html">Name_rr_map</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Name resource record map</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Packet" class="anchored"><a href="#module-Packet" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Packet/index.html">Packet</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The DNS packet.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Tsig_op" class="anchored"><a href="#module-Tsig_op" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Tsig_op/index.html">Tsig_op</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Signature operations and their errors.</p></div></div></div></body></html>