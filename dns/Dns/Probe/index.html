<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Probe (dns.Dns.Probe)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">dns</a> &#x00BB; <a href="../index.html">Dns</a> &#x00BB; Probe</nav><h1>Module <code>Dns.Probe</code></h1></header><aside><p>Implements the core of the unique name probing part of a Multicast DNS (mDNS) responder.</p></aside><dl><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type </span>state</code></dt><dd><p>The internal data structure representing the of the probing part of an mDNS responder.</p></dd></dl><dl><dt class="spec type" id="type-datagram"><a href="#type-datagram" class="anchor"></a><code><span class="keyword">type </span>datagram</code><code><span class="keyword"> = </span><a href="../Packet/index.html#type-t">Packet.t</a><span class="keyword"> * </span>Ipaddr.V4.t<span class="keyword"> * </span>int</code></dt><dd><p>A DNS packet to be sent with its destination IP address and UDP port number.</p></dd></dl><dl><dt class="spec type" id="type-action"><a href="#type-action" class="anchor"></a><code><span class="keyword">type </span>action</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-action.Nothing" class="anchored"><td class="def constructor"><a href="#type-action.Nothing" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Nothing</span></code></td><td class="doc"><p>The protocol is idle because all names have been confirmed unique.</p></td></tr><tr id="type-action.ToSend" class="anchored"><td class="def constructor"><a href="#type-action.ToSend" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">ToSend</span><span class="keyword"> of </span><a href="index.html#type-datagram">datagram</a></code></td><td class="doc"><p>The caller shall send the specified <code>datagram</code>.</p></td></tr><tr id="type-action.Delay" class="anchored"><td class="def constructor"><a href="#type-action.Delay" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Delay</span><span class="keyword"> of </span>float</code></td><td class="doc"><p>The caller shall wait for the specified duration in seconds.</p></td></tr><tr id="type-action.Continue" class="anchored"><td class="def constructor"><a href="#type-action.Continue" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Continue</span></code></td><td class="doc"><p>The caller should invoke <code>do_probe</code> again.</p></td></tr><tr id="type-action.NotReady" class="anchored"><td class="def constructor"><a href="#type-action.NotReady" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">NotReady</span></code></td><td class="doc"><p>The call was unexpected. This may indicate a bug in the caller, and should be logged.</p></td></tr><tr id="type-action.Stop" class="anchored"><td class="def constructor"><a href="#type-action.Stop" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Stop</span></code></td><td class="doc"><p><code>stop</code> has been called.</p></td></tr></table></dt><dd><p>The I/O action that the caller of this module must take.</p></dd></dl><dl><dt class="spec value" id="val-new_state"><a href="#val-new_state" class="anchor"></a><code><span class="keyword">val </span>new_state : <a href="../Loader/index.html#type-db">Loader.db</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>Initialises a new mDNS probe protocol.</p></dd></dl><dl><dt class="spec value" id="val-add_name"><a href="#val-add_name" class="anchor"></a><code><span class="keyword">val </span>add_name : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>Marks a Name.t as unique. The name will be included in the next probe cycle.</p></dd></dl><dl><dt class="spec value" id="val-do_probe"><a href="#val-do_probe" class="anchor"></a><code><span class="keyword">val </span>do_probe : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a><span class="keyword"> * </span><a href="index.html#type-action">action</a></code></dt><dd><p>Initiates the probe protocol and returns the I/O action that the caller should take.</p></dd></dl><dl><dt class="spec value" id="val-on_send_complete"><a href="#val-on_send_complete" class="anchor"></a><code><span class="keyword">val </span>on_send_complete : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a><span class="keyword"> * </span><a href="index.html#type-action">action</a></code></dt><dd><p>After completing a <code>ToSend</code> action, call this function to continue the probe protocol.</p></dd></dl><dl><dt class="spec value" id="val-on_delay_complete"><a href="#val-on_delay_complete" class="anchor"></a><code><span class="keyword">val </span>on_delay_complete : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a><span class="keyword"> * </span><a href="index.html#type-action">action</a></code></dt><dd><p>After completing a <code>Delay</code> action, call this function to continue the probe protocol.</p></dd></dl><dl><dt class="spec value" id="val-is_first_complete"><a href="#val-is_first_complete" class="anchor"></a><code><span class="keyword">val </span>is_first_complete : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Returns <code>true</code> if the first probe cycle has completed successfully.</p></dd></dl><dl><dt class="spec type" id="type-conflict"><a href="#type-conflict" class="anchor"></a><code><span class="keyword">type </span>conflict</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-conflict.NoConflict" class="anchored"><td class="def constructor"><a href="#type-conflict.NoConflict" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">NoConflict</span></code></td><td class="doc"><p>No conflict occurred.</p></td></tr><tr id="type-conflict.ConflictRestart" class="anchored"><td class="def constructor"><a href="#type-conflict.ConflictRestart" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">ConflictRestart</span></code></td><td class="doc"><p>A conflict occurred. The caller should interrupt any <code>Delay</code> action that is currently executing, if possible.</p></td></tr></table></dt><dd><p>Indicates whether the received datagram caused a restart of the probe cycle due to a conflict.</p></dd></dl><dl><dt class="spec value" id="val-on_response_received"><a href="#val-on_response_received" class="anchor"></a><code><span class="keyword">val </span>on_response_received : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="../Packet/index.html#type-t">Packet.t</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a><span class="keyword"> * </span><a href="index.html#type-conflict">conflict</a></code></dt><dd><p>Call this function when an mDNS response packet is received, in order to check for conflicting resource records.</p></dd></dl><dl><dt class="spec value" id="val-on_query_received"><a href="#val-on_query_received" class="anchor"></a><code><span class="keyword">val </span>on_query_received : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="../Packet/index.html#type-t">Packet.t</a> <span>&#45;&gt;</span> <a href="../Packet/index.html#type-t">Packet.t</a> <span>&#45;&gt;</span> <a href="../Packet/index.html#type-t">Packet.t</a><span class="keyword"> * </span><a href="index.html#type-state">state</a><span class="keyword"> * </span><a href="index.html#type-conflict">conflict</a></code></dt><dd><p>Call this function when an mDNS query packet is received, in order to check for simultaneous probe conflicts.</p></dd></dl><dl><dt class="spec value" id="val-is_confirmed"><a href="#val-is_confirmed" class="anchor"></a><code><span class="keyword">val </span>is_confirmed : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Returns <code>true</code> if the name has been confirmed unique (probed successfully). This is intended for controlling the cache flush bit.</p></dd></dl><dl><dt class="spec value" id="val-stop"><a href="#val-stop" class="anchor"></a><code><span class="keyword">val </span>stop : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>Stops executing the protocol.</p></dd></dl></div></body></html>