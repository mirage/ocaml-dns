<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dns_trie (dns-server.Dns_trie)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">dns-server</a> &#x00BB; Dns_trie</nav><header class="odoc-preamble"><h1>Module <code><span>Dns_trie</span></code></h1><p>Prefix tree data structure for domain names</p><p>The key is a <code>Dns_name</code>, whereas the value may be any resource record. The representation is a tree, where the edges are domain name labels, and the nodes carry a <span class="xref-unresolved">resource map</span>. Some special treatment is applied for zones, which must have a start of authority entry and a set of name servers. End of authority, also known as delegation, is supported. Aliases (canonical names, CNAME records) are also supported.</p><p>The data structure tries to preserve invariants recommended by the domain name system, such as that for any name there may either be an alias or any other record, there must be a SOA record, and multiple NS records for an authoritative zone, a resource type must have entries of the given type (no NS record for A type, the ttl for all resource records of a rrset is the same.</p></header><nav class="odoc-toc"><ul><li><a href="#abstract-trie-type">Abstract trie type</a></li><li><a href="#operations-to-modify-the-trie">Operations to modify the trie</a></li><li><a href="#checking-invariants">Checking invariants</a></li><li><a href="#lookup">Lookup</a></li></ul></nav><div class="odoc-content"><h3 id="abstract-trie-type"><a href="#abstract-trie-type" class="anchor"></a>Abstract trie type</h3><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>The type of the trie.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><a href="#type-t">t</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp ppf t</code> pretty prints <code>t</code> to <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>empty</code> is the empty trie.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal a b</code> compares <code>a</code> with <code>b</code>.</p></div></div><h3 id="operations-to-modify-the-trie"><a href="#operations-to-modify-the-trie" class="anchor"></a>Operations to modify the trie</h3><div class="odoc-spec"><div class="spec value anchored" id="val-insert_map"><a href="#val-insert_map" class="anchor"></a><code><span><span class="keyword">val</span> insert_map : <span><span><a href="../../dns/Dns/Rr_map/index.html#type-t">Dns.Rr_map.t</a> <span class="xref-unresolved">Domain_name</span>.Map.t</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>insert_map m t</code> inserts all elements of the domain name map <code>m</code> into <code>t</code>, potentially existing are unioned with <code>Rr_map</code>.unionee.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-replace_map"><a href="#val-replace_map" class="anchor"></a><code><span><span class="keyword">val</span> replace_map : <span><span><a href="../../dns/Dns/Rr_map/index.html#type-t">Dns.Rr_map.t</a> <span class="xref-unresolved">Domain_name</span>.Map.t</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>replace_map m t</code> replaces in the trie <code>t</code> all existing bindings of the domain name map <code>m</code> with the provided map.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_map"><a href="#val-remove_map" class="anchor"></a><code><span><span class="keyword">val</span> remove_map : <span><span><a href="../../dns/Dns/Rr_map/index.html#type-t">Dns.Rr_map.t</a> <span class="xref-unresolved">Domain_name</span>.Map.t</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>remove_map m t</code> removes all elements of the domain name map <code>m</code> from <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-insert"><a href="#val-insert" class="anchor"></a><code><span><span class="keyword">val</span> insert : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../dns/Dns/Rr_map/index.html#type-key">Dns.Rr_map.key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>insert n k v t</code> inserts <code>k, v</code> under <code>n</code> in <code>t</code>. Existing entries are unioneed with <code>Rr_map</code>.union_rr.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-replace"><a href="#val-replace" class="anchor"></a><code><span><span class="keyword">val</span> replace : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../dns/Dns/Rr_map/index.html#type-key">Dns.Rr_map.key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>replace n k v t</code> inserts <code>k, v</code> under <code>n</code> in <code>t</code>. Existing entries are replaced.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove"><a href="#val-remove" class="anchor"></a><code><span><span class="keyword">val</span> remove : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../dns/Dns/Rr_map/index.html#type-key">Dns.Rr_map.key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>remove k ty v t</code> removes <code>ty, v</code> from <code>t</code> at <code>k</code>. Beware, this may lead to a <code>t</code> where the initially mentioned invariants are violated.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_ty"><a href="#val-remove_ty" class="anchor"></a><code><span><span class="keyword">val</span> remove_ty : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../dns/Dns/Rr_map/index.html#type-key">Dns.Rr_map.key</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>remove_ty k ty t</code> removes <code>ty</code> from <code>t</code> at <code>k</code>. Beware, this may lead to a <code>t</code> where the initially mentioned invariants are violated.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_all"><a href="#val-remove_all" class="anchor"></a><code><span><span class="keyword">val</span> remove_all : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>remove_all k t</code> removes all entries of <code>k</code> in <code>t</code>. Beware, this may lead to a <code>t</code> where the initially mentioned invariants are violated.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_zone"><a href="#val-remove_zone" class="anchor"></a><code><span><span class="keyword">val</span> remove_zone : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>remove_zone name t</code> remove the zone <code>name</code> from <code>t</code>, retaining subzones (entries with <code>Soa</code> records). This removes as well any delegations.</p></div></div><h3 id="checking-invariants"><a href="#checking-invariants" class="anchor"></a>Checking invariants</h3><div class="odoc-spec"><div class="spec type anchored" id="type-zone_check"><a href="#type-zone_check" class="anchor"></a><code><span><span class="keyword">type</span> zone_check</span><span> = </span><span>[ </span></code><ol><li id="type-zone_check.Missing_soa" class="def constructor anchored"><a href="#type-zone_check.Missing_soa" class="anchor"></a><code><span>| </span></code><code><span>`Missing_soa <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span></span></code></li><li id="type-zone_check.Cname_other" class="def constructor anchored"><a href="#type-zone_check.Cname_other" class="anchor"></a><code><span>| </span></code><code><span>`Cname_other <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span></span></code></li><li id="type-zone_check.Bad_ttl" class="def constructor anchored"><a href="#type-zone_check.Bad_ttl" class="anchor"></a><code><span>| </span></code><code><span>`Bad_ttl <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <a href="../../dns/Dns/Rr_map/index.html#type-b">Dns.Rr_map.b</a></span></code></li><li id="type-zone_check.Empty" class="def constructor anchored"><a href="#type-zone_check.Empty" class="anchor"></a><code><span>| </span></code><code><span>`Empty <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <a href="../../dns/Dns/Rr_map/index.html#type-k">Dns.Rr_map.k</a></span></code></li><li id="type-zone_check.Missing_address" class="def constructor anchored"><a href="#type-zone_check.Missing_address" class="anchor"></a><code><span>| </span></code><code><span>`Missing_address <span class="keyword">of</span> <span><span>[ `host ]</span> <span class="xref-unresolved">Domain_name</span>.t</span></span></code></li><li id="type-zone_check.Soa_not_a_host" class="def constructor anchored"><a href="#type-zone_check.Soa_not_a_host" class="anchor"></a><code><span>| </span></code><code><span>`Soa_not_a_host <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * string</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_zone_check"><a href="#val-pp_zone_check" class="anchor"></a><code><span><span class="keyword">val</span> pp_zone_check : <span><a href="#type-zone_check">zone_check</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_err ppf err</code> pretty prints the error <code>err</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check"><a href="#val-check" class="anchor"></a><code><span><span class="keyword">val</span> check : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="#type-zone_check">zone_check</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>check t</code> checks all invariants.</p></div></div><h3 id="lookup"><a href="#lookup" class="anchor"></a>Lookup</h3><div class="odoc-spec"><div class="spec type anchored" id="type-e"><a href="#type-e" class="anchor"></a><code><span><span class="keyword">type</span> e</span><span> = </span><span>[ </span></code><ol><li id="type-e.Delegation" class="def constructor anchored"><a href="#type-e.Delegation" class="anchor"></a><code><span>| </span></code><code><span>`Delegation <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <span>(int32 * <span class="xref-unresolved">Domain_name</span>.Host_set.t)</span></span></code></li><li id="type-e.EmptyNonTerminal" class="def constructor anchored"><a href="#type-e.EmptyNonTerminal" class="anchor"></a><code><span>| </span></code><code><span>`EmptyNonTerminal <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <a href="../../dns/Dns/Soa/index.html#type-t">Dns.Soa.t</a></span></code></li><li id="type-e.NotAuthoritative" class="def constructor anchored"><a href="#type-e.NotAuthoritative" class="anchor"></a><code><span>| </span></code><code><span>`NotAuthoritative</span></code></li><li id="type-e.NotFound" class="def constructor anchored"><a href="#type-e.NotFound" class="anchor"></a><code><span>| </span></code><code><span>`NotFound <span class="keyword">of</span> <span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <a href="../../dns/Dns/Soa/index.html#type-t">Dns.Soa.t</a></span></code></li></ol><code><span> ]</span></code></div><div class="spec-doc"><p>The type of lookup errors.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_e"><a href="#val-pp_e" class="anchor"></a><code><span><span class="keyword">val</span> pp_e : <span><a href="#type-e">e</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp_e ppf e</code> pretty-prints <code>e</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-zone"><a href="#val-zone" class="anchor"></a><code><span><span class="keyword">val</span> zone : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * <a href="../../dns/Dns/Soa/index.html#type-t">Dns.Soa.t</a>, <a href="#type-e">e</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>zone k t</code> returns either the zone and soa for <code>k</code> in <code>t</code>, or an error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lookup_with_cname"><a href="#val-lookup_with_cname" class="anchor"></a><code><span><span class="keyword">val</span> lookup_with_cname : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="../../dns/Dns/Rr_map/index.html#type-key">Dns.Rr_map.key</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../dns/Dns/Rr_map/index.html#type-b">Dns.Rr_map.b</a> * <span>(<span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * int32 * <span class="xref-unresolved">Domain_name</span>.Host_set.t)</span>, <a href="#type-e">e</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>lookup_with_cname k ty t</code> finds <code>k, ty</code> in <code>t</code>. It either returns the found resource record set and authority information, a cname alias and authority information, or an error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lookup"><a href="#val-lookup" class="anchor"></a><code><span><span class="keyword">val</span> lookup : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="../../dns/Dns/Rr_map/index.html#type-key">Dns.Rr_map.key</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'b</span>, <a href="#type-e">e</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>lookup k ty t</code> finds <code>k, ty</code> in <code>t</code>, which may lead to an error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lookup_any"><a href="#val-lookup_any" class="anchor"></a><code><span><span class="keyword">val</span> lookup_any : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../dns/Dns/Rr_map/index.html#type-t">Dns.Rr_map.t</a> * <span>(<span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> * int32 * <span class="xref-unresolved">Domain_name</span>.Host_set.t)</span>, <a href="#type-e">e</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>lookup_any k t</code> looks up all resource records of <code>k</code> in <code>t</code>, and returns that and the authority information.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lookup_glue"><a href="#val-lookup_glue" class="anchor"></a><code><span><span class="keyword">val</span> lookup_glue : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(int32 * <span class="xref-unresolved">Ipaddr</span>.V4.Set.t)</span> option</span> * <span><span>(int32 * <span class="xref-unresolved">Ipaddr</span>.V6.Set.t)</span> option</span></span></code></div><div class="spec-doc"><p><code>lookup_glue k t</code> finds glue records (A, AAAA) for <code>k</code> in <code>t</code>. It ignores potential DNS invariants, e.g. that there is no surrounding zone.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-entries"><a href="#val-entries" class="anchor"></a><code><span><span class="keyword">val</span> entries : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../dns/Dns/Soa/index.html#type-t">Dns.Soa.t</a> * <span><a href="../../dns/Dns/Rr_map/index.html#type-t">Dns.Rr_map.t</a> <span class="xref-unresolved">Domain_name</span>.Map.t</span>, <a href="#type-e">e</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>entries name t</code> returns either the SOA and all entries for the requested <code>name</code>, or an error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fold"><a href="#val-fold" class="anchor"></a><code><span><span class="keyword">val</span> fold : 
  <span><span><span class="type-var">'a</span> <a href="../../dns/Dns/Rr_map/index.html#type-key">Dns.Rr_map.key</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span><span>[ `raw ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>fold key t f acc</code> calls <code>f</code> with <code>dname value acc</code> element in <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-diff"><a href="#val-diff" class="anchor"></a><code><span><span class="keyword">val</span> diff : 
  <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../dns/Dns/Soa/index.html#type-t">Dns.Soa.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>old:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../dns/Dns/Soa/index.html#type-t">Dns.Soa.t</a>
   * <span>[ `Empty
     <span><span>| `Full</span> of <a href="../../dns/Dns/Name_rr_map/index.html#type-t">Dns.Name_rr_map.t</a></span>
     <span><span>| `Difference</span> of <a href="../../dns/Dns/Soa/index.html#type-t">Dns.Soa.t</a> * <a href="../../dns/Dns/Name_rr_map/index.html#type-t">Dns.Name_rr_map.t</a> * <a href="../../dns/Dns/Name_rr_map/index.html#type-t">Dns.Name_rr_map.t</a></span> ]</span>,
    <span>[&gt; <span>`Msg of string</span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>diff zone soa ~old trie</code> computes the difference of <code>zone</code> in <code>old</code> and <code>trie</code>, and returns either <code>`Empty</code> if <code>soa</code> is equal or newer than the one in <code>trie</code>, <code>`Full</code> (the same as <code>entries</code>) if <code>zone</code> is not present in <code>old</code>, or <code>`Difference (old_soa, deleted, added)</code>. Best used with IXFR. An error occurs if <code>zone</code> is not present in <code>trie</code>.</p></div></div></div></body></html>